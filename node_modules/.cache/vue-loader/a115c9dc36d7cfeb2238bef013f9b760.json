{"remainingRequest":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue?vue&type=style&index=0&id=e403a3d6&lang=less&scoped=true&","dependencies":[{"path":"/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue","mtime":1571907941321},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.questionnaire {\n  width: 100%;\n}\n.questionnaire-name {\n  width: 100%;\n  padding: 0 15px 0px;\n  background: #fff;\n  position: fixed;\n  top: 0;\n  z-index: 9;\n  .title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 22px 0 0;\n  }\n  .progress {\n    font-size: 12px;\n    color: #fcab37;\n    margin-left: 7px;\n  }\n}\n/deep/.mt-progress-runway {\n  background: #cfcfcf;\n  border-radius: 4px;\n}\n/deep/.mt-progress-progress {\n  background-color: #fcab37;\n}\n.content {\n  margin-top: 93px;\n  margin-bottom: 100px;\n}\n.question-list {\n  background: #fff;\n  margin: 15px;\n  padding: 13px 0 0 0;\n  .require-statu {\n    color: red;\n  }\n}\n.question-list > .title {\n  font-size: 14px;\n  color: #333333;\n  margin-bottom: 13px;\n}\n.question-list .item-type {\n  color: #fd9e2f;\n}\n.submit {\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 100px;\n  background: linear-gradient(\n    0deg,\n    rgba(255, 255, 255, 1) 0%,\n    rgba(255, 255, 255, 0) 100%\n  );\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .button {\n    width: 175px;\n    background: #fcab37;\n    height: 44px;\n    border-radius: 22px;\n    color: #fff;\n    font-size: 16px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/questionnaire","sourcesContent":["<template>\n  <div class=\"questionnaire\">\n    <div class=\"questionnaire-name\">\n      <p class=\"title\">{{title}}</p>\n      <mt-progress :value=\"progressWidth\">\n        <div class=\"progress\" slot=\"end\">{{progressWidthTest}}</div>\n      </mt-progress>\n    </div>\n    <div class=\"content\">\n      <div class=\"question-list\" v-for=\"(item,index) in questionList\" :key=\"item.keys\">\n        <div class=\"title\">\n          <span v-if=\"item.type==='Radio'\" class=\"item-type\">「单选题」</span>\n          <span v-else-if=\"item.type==='CheckBox'\" class=\"item-type\">「多选题」</span>\n          <span v-else-if=\"item.type==='Textarea'\" class=\"item-type\">「问答题」</span>\n          <span v-else-if=\"item.type==='Datepicker'\" class=\"item-type\">「日期」</span>\n          <span v-else class=\"item-type\">「时间」</span>\n          <span v-if=\"item.require==='true'\" class=\"require-statu\">*</span>\n          <span>{{index+1}}.</span>\n          {{item.name}}\n        </div>\n        <component :form=\"form\" :is=\"'Ell' + item.type\" :pitem=\"item\" :post=\"item.keys\" />\n      </div>\n    </div>\n    <div class=\"submit\">\n      <div class=\"button\" @click=\"submit\">提交问卷</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport EllRadio from \"../../components/questionnaire/radio\"; //单选\nimport EllTextarea from \"../../components/questionnaire/textarea\"; //问答\nimport EllCheckBox from \"../../components/questionnaire/checkbox\"; //多选\nimport EllDatepicker from \"../../components/questionnaire/datepicker\"; //日期\nimport EllTimepicker from \"../../components/questionnaire/timepicker\"; //时间\nimport { Toast } from \"mint-ui\";\nimport { isArray } from \"util\";\nimport qs from \"qs\";\nexport default {\n  components: {\n    EllRadio,\n    EllTextarea,\n    EllCheckBox,\n    EllDatepicker,\n    EllTimepicker\n  },\n  data() {\n    return {\n      form: {},\n      title: \"浙江省调查问卷\",\n      progressWidth: null,\n      progressWidthTest: \"\",\n      questionList: []\n    };\n  },\n\n  mounted() {\n    this.getData();\n  },\n  methods: {\n    getData() {\n      console.log(process.env.NODE_ENV);\n\n      let dic = qs.stringify({\n        surveyQuestionId: \"BA869ADB974D4BE282FEF49C9DBD6159\"\n      });\n\n      this.$http\n        .post(\n          process.env.NODE_ENV === \"development\"\n            ? \"/api/api/surveyQuestionInfo\"\n            : \"/api/surveyQuestionInfo\",\n          dic,\n          {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          }\n        )\n        .then(res => {\n          this.questionList = [];\n          this.questionList = JSON.parse(res.data.data.surveyQuestionContent);\n          this.questionList.forEach(item => {\n            this.$set(this.form, item.keys, item.value);\n          });\n        });\n    },\n\n    //提交表单\n    submit() {\n      let isStop;\n      this.questionList.forEach((item, index) => {\n        if (\n          item.require == \"true\" &&\n          (item.value === undefined || item.value === \"\" || item.value === [])\n        ) {\n          //验证必填\n          isStop = true;\n          Toast(`第${index + 1}道题是必填项，请填写`);\n          return;\n        }\n      });\n      if (!isStop) {\n        let dic = qs.stringify({\n          surveyQuestionId: \"BA869ADB974D4BE282FEF49C9DBD6159\",\n          surveyAnswerContent: JSON.stringify(this.questionList)\n        });\n\n        this.$http\n          .post(\"/api/api/survey/saveSurveyAnswer\", dic, {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          })\n          .then(res => {\n            Toast(\"提交成功\");\n          });\n      }\n    }\n  },\n  watch: {\n    form: {\n      handler(val, oldVal) {\n        // 监听表单变化\n        let writeArr = [];\n        this.questionList.forEach((item, index) => {\n          item.value = this.form[item.keys]; //赋值\n          //问题已填写\n          if (item.value && item.value !== (\"\" || undefined)) {\n            writeArr.push(item);\n          }\n          //问题填写后又置空\n          let state = writeArr.some(it => it.keys === item.keys);\n          if (item.value === \"\" && state) {\n            writeArr.forEach((items, index) => {\n              if (items.keys === item.keys) {\n                writeArr.splice(inde, 1);\n              }\n            });\n          }\n        });\n        console.log(writeArr + \"填写\");\n        this.progressWidth = (writeArr.length / this.questionList.length) * 100;\n        this.progressWidthTest =\n          writeArr.length + \"/\" + this.questionList.length;\n      },\n      deep: true\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.questionnaire {\n  width: 100%;\n}\n.questionnaire-name {\n  width: 100%;\n  padding: 0 15px 0px;\n  background: #fff;\n  position: fixed;\n  top: 0;\n  z-index: 9;\n  .title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 22px 0 0;\n  }\n  .progress {\n    font-size: 12px;\n    color: #fcab37;\n    margin-left: 7px;\n  }\n}\n/deep/.mt-progress-runway {\n  background: #cfcfcf;\n  border-radius: 4px;\n}\n/deep/.mt-progress-progress {\n  background-color: #fcab37;\n}\n.content {\n  margin-top: 93px;\n  margin-bottom: 100px;\n}\n.question-list {\n  background: #fff;\n  margin: 15px;\n  padding: 13px 0 0 0;\n  .require-statu {\n    color: red;\n  }\n}\n.question-list > .title {\n  font-size: 14px;\n  color: #333333;\n  margin-bottom: 13px;\n}\n.question-list .item-type {\n  color: #fd9e2f;\n}\n.submit {\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 100px;\n  background: linear-gradient(\n    0deg,\n    rgba(255, 255, 255, 1) 0%,\n    rgba(255, 255, 255, 0) 100%\n  );\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .button {\n    width: 175px;\n    background: #fcab37;\n    height: 44px;\n    border-radius: 22px;\n    color: #fff;\n    font-size: 16px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>"]}]}