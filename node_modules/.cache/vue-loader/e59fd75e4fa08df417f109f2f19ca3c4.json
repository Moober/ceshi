{"remainingRequest":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue","mtime":1571733939618},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport EllRadio from \"../../components/questionnaire/radio\"; //单选\nimport EllTextarea from \"../../components/questionnaire/textarea\"; //问答\nimport EllCheckBox from \"../../components/questionnaire/checkbox\"; //多选\nimport EllDatepicker from \"../../components/questionnaire/datepicker\"; //日期\nimport EllTimepicker from \"../../components/questionnaire/timepicker\"; //时间\nimport { Toast } from \"mint-ui\";\nimport { isArray } from \"util\";\nexport default {\n  components: {\n    EllRadio,\n    EllTextarea,\n    EllCheckBox,\n    EllDatepicker,\n    EllTimepicker\n  },\n  data() {\n    return {\n      form: {},\n      title: \"浙江省调查问卷\",\n      progressWidth: null,\n      questionList: [\n        {\n          name: \"性别\",\n          require: \"true\",\n          type: \"Radio\",\n          radioList: [\n            {\n              name: \"男\"\n            },\n            {\n              name: \"女\"\n            }\n          ]\n        },\n        {\n          name: \"备注\",\n          require: \"true\",\n          type: \"Textarea\"\n        },\n        {\n          name: \"这是一个多选\",\n          require: \"true\",\n          type: \"CheckBox\",\n          checkList: [\n            {\n              name: \"男\"\n            },\n            {\n              name: \"女\"\n            }\n          ]\n        },\n        {\n          name: \"日期\",\n          require: \"true\",\n          type: \"Datepicker\"\n        },\n        {\n          name: \"时间\",\n          require: \"true\",\n          type: \"Timepicker\"\n        }\n      ]\n    };\n  },\n\n  mounted() {\n    this.questionList.forEach(item => {\n      this.$set(this.form, item.name, item.value);\n    });\n    console.log(this.questionList);\n    this.getData();\n  },\n  methods: {\n    getData() {\n      let dic = JSON.stringify({\n        surveyQuestionId: \"26EF46725B3C48DFAE72B15E7A32E0E9\"\n      });\n\n      this.$http\n        .post(\"/api/api/surveyQuestionInfo\", dic, {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        })\n        .then(data => {});\n    },\n\n    //提交表单\n    submit() {\n      this.questionList.forEach((item, index) => {\n        console.log(item);\n        if (\n          item.require == \"true\" &&\n          (item.value === undefined || item.value === \"\" || item.value === [])\n        ) {\n          //验证必填\n          Toast(`第${index + 1}道题是必填项，请填写`);\n          return;\n        }\n      });\n      console.log(\"成功\");\n    }\n  },\n  watch: {\n    form: {\n      handler(val, oldVal) {\n        // 监听表单变化\n        let writeArr = [];\n        this.questionList.forEach((item, index) => {\n          // if (this.form[item.name]) {\n          item.value = this.form[item.name]; //赋值\n          // }\n          //问题已填写\n          if (item.value && item.value !== (\"\" || undefined)) {\n            writeArr.push(item);\n          }\n          //问题填写后又置空\n          let state = writeArr.some(it => it.name === item.name);\n          if (item.value === \"\" && state) {\n            writeArr.forEach((items, index) => {\n              if (items.name === item.name) {\n                writeArr.splice(inde, 1);\n              }\n            });\n          }\n        });\n        console.log(writeArr);\n        this.progressWidth = (writeArr.length / this.questionList.length) * 100;\n      },\n      deep: true\n    }\n  }\n};\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/questionnaire","sourcesContent":["<template>\n  <div class=\"questionnaire\">\n    <div class=\"questionnaire-name\">\n      <p class=\"title\">{{title}}</p>\n      <mt-progress :value=\"progressWidth\">\n        <div class=\"progress\" slot=\"end\">{{progressWidth}}%</div>\n      </mt-progress>\n    </div>\n    <div class=\"content\">\n      <div class=\"question-list\" v-for=\"(item,index) in questionList\" :key=\"item.keys\">\n        <div class=\"title\">\n          <span v-if=\"item.type==='Radio'\" class=\"item-type\">「单选题」</span>\n          <span v-else-if=\"item.type==='CheckBox'\" class=\"item-type\">「多选题」</span>\n          <span v-else-if=\"item.type==='Textarea'\" class=\"item-type\">「问答题」</span>\n          <span v-else-if=\"item.type==='Datepicker'\" class=\"item-type\">「日期」</span>\n          <span v-else class=\"item-type\">「时间」</span>\n          <span v-if=\"item.require==='true'\" class=\"require-statu\">*</span>\n          <span>{{index+1}}.</span>\n          {{item.name}}\n        </div>\n        <component :form=\"form\" :is=\"'Ell' + item.type\" :pitem=\"item\" :post=\"item.name\" />\n      </div>\n    </div>\n    <div class=\"submit\">\n      <div class=\"button\" @click=\"submit\">提交问卷</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport EllRadio from \"../../components/questionnaire/radio\"; //单选\nimport EllTextarea from \"../../components/questionnaire/textarea\"; //问答\nimport EllCheckBox from \"../../components/questionnaire/checkbox\"; //多选\nimport EllDatepicker from \"../../components/questionnaire/datepicker\"; //日期\nimport EllTimepicker from \"../../components/questionnaire/timepicker\"; //时间\nimport { Toast } from \"mint-ui\";\nimport { isArray } from \"util\";\nexport default {\n  components: {\n    EllRadio,\n    EllTextarea,\n    EllCheckBox,\n    EllDatepicker,\n    EllTimepicker\n  },\n  data() {\n    return {\n      form: {},\n      title: \"浙江省调查问卷\",\n      progressWidth: null,\n      questionList: [\n        {\n          name: \"性别\",\n          require: \"true\",\n          type: \"Radio\",\n          radioList: [\n            {\n              name: \"男\"\n            },\n            {\n              name: \"女\"\n            }\n          ]\n        },\n        {\n          name: \"备注\",\n          require: \"true\",\n          type: \"Textarea\"\n        },\n        {\n          name: \"这是一个多选\",\n          require: \"true\",\n          type: \"CheckBox\",\n          checkList: [\n            {\n              name: \"男\"\n            },\n            {\n              name: \"女\"\n            }\n          ]\n        },\n        {\n          name: \"日期\",\n          require: \"true\",\n          type: \"Datepicker\"\n        },\n        {\n          name: \"时间\",\n          require: \"true\",\n          type: \"Timepicker\"\n        }\n      ]\n    };\n  },\n\n  mounted() {\n    this.questionList.forEach(item => {\n      this.$set(this.form, item.name, item.value);\n    });\n    console.log(this.questionList);\n    this.getData();\n  },\n  methods: {\n    getData() {\n      let dic = JSON.stringify({\n        surveyQuestionId: \"26EF46725B3C48DFAE72B15E7A32E0E9\"\n      });\n\n      this.$http\n        .post(\"/api/api/surveyQuestionInfo\", dic, {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        })\n        .then(data => {});\n    },\n\n    //提交表单\n    submit() {\n      this.questionList.forEach((item, index) => {\n        console.log(item);\n        if (\n          item.require == \"true\" &&\n          (item.value === undefined || item.value === \"\" || item.value === [])\n        ) {\n          //验证必填\n          Toast(`第${index + 1}道题是必填项，请填写`);\n          return;\n        }\n      });\n      console.log(\"成功\");\n    }\n  },\n  watch: {\n    form: {\n      handler(val, oldVal) {\n        // 监听表单变化\n        let writeArr = [];\n        this.questionList.forEach((item, index) => {\n          // if (this.form[item.name]) {\n          item.value = this.form[item.name]; //赋值\n          // }\n          //问题已填写\n          if (item.value && item.value !== (\"\" || undefined)) {\n            writeArr.push(item);\n          }\n          //问题填写后又置空\n          let state = writeArr.some(it => it.name === item.name);\n          if (item.value === \"\" && state) {\n            writeArr.forEach((items, index) => {\n              if (items.name === item.name) {\n                writeArr.splice(inde, 1);\n              }\n            });\n          }\n        });\n        console.log(writeArr);\n        this.progressWidth = (writeArr.length / this.questionList.length) * 100;\n      },\n      deep: true\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.questionnaire {\n  width: 100%;\n}\n.questionnaire-name {\n  width: 100%;\n  padding: 0 15px 0px;\n  background: #fff;\n  position: fixed;\n  top: 0;\n  z-index: 9;\n  .title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 22px 0 0;\n  }\n  .progress {\n    font-size: 12px;\n    color: #fcab37;\n    margin-left: 7px;\n  }\n}\n/deep/.mt-progress-runway {\n  background: #cfcfcf;\n  border-radius: 4px;\n}\n/deep/.mt-progress-progress {\n  background-color: #fcab37;\n}\n.content {\n  margin-top: 93px;\n}\n.question-list {\n  background: #fff;\n  margin: 15px;\n  padding: 13px 0 0 0;\n  .require-statu {\n    color: red;\n  }\n}\n.question-list > .title {\n  font-size: 14px;\n  color: #333333;\n  margin-bottom: 13px;\n}\n.question-list .item-type {\n  color: #fd9e2f;\n}\n.submit {\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 100px;\n  background: linear-gradient(\n    0deg,\n    rgba(255, 255, 255, 1) 0%,\n    rgba(255, 255, 255, 0) 100%\n  );\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .button {\n    width: 175px;\n    background: #fcab37;\n    height: 44px;\n    border-radius: 22px;\n    color: #fff;\n    font-size: 16px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>"]}]}