{"remainingRequest":"/Users/zhaochen/Workspace/mobile-survey/node_modules/babel-loader/lib/index.js!/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaochen/Workspace/mobile-survey/src/views/questionnaire/index.vue","mtime":1572527756697},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaochen/Workspace/mobile-survey/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport EllRadio from \"../../components/questionnaire/radio\"; //单选\n\nimport EllTextarea from \"../../components/questionnaire/textarea\"; //问答\n\nimport EllCheckBox from \"../../components/questionnaire/checkbox\"; //多选\n\nimport EllDatepicker from \"../../components/questionnaire/datepicker\"; //日期\n\nimport EllTimepicker from \"../../components/questionnaire/timepicker\"; //时间\n\nimport { Toast } from \"mint-ui\";\nimport { isArray } from \"util\";\nimport qs from \"qs\";\nexport default {\n  components: {\n    EllRadio: EllRadio,\n    EllTextarea: EllTextarea,\n    EllCheckBox: EllCheckBox,\n    EllDatepicker: EllDatepicker,\n    EllTimepicker: EllTimepicker\n  },\n  data: function data() {\n    return {\n      form: {},\n      title: \"调查问卷\",\n      progressWidth: null,\n      progressWidthTest: \"\",\n      questionList: [],\n      surveyQuestionId: \"\"\n    };\n  },\n  mounted: function mounted() {\n    this.surveyQuestionId = this.$route.query.id;\n    this.getData();\n  },\n  methods: {\n    showPicker: function showPicker(val) {\n      /*解决页面层级相互影响滑动的问题*/\n      function bodyScroll(e) {\n        e.preventDefault();\n      }\n\n      if (val) {\n        document.body.addEventListener(\"touchmove\", bodyScroll, false); //阻止默认事件\n      } else {\n        document.body.removeEventListener(\"touchmove\", bodyScroll, false); //打开默认事件\n      }\n    },\n    getData: function getData() {\n      var _this = this;\n\n      var dic = qs.stringify({\n        surveyQuestionId: this.surveyQuestionId\n      });\n      this.$http.post(process.env.NODE_ENV === \"development\" ? \"/api/api/surveyQuestionInfo\" : \"/api/surveyQuestionInfo\", dic, {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      }).then(function (res) {\n        _this.questionList = [];\n        _this.title = res.data.data.surveyQuestionName;\n        _this.questionList = JSON.parse(res.data.data.surveyQuestionContent);\n\n        _this.questionList.forEach(function (item) {\n          _this.$set(_this.form, item.keys, item.value);\n        });\n      });\n    },\n    //提交表单\n    submit: function submit() {\n      var _this2 = this;\n\n      var isStop;\n      this.questionList.forEach(function (item, index) {\n        if (item.require == \"true\" && (item.value === undefined || item.value === \"\" || item.value === [])) {\n          //验证必填\n          isStop = true;\n          Toast(\"\\u7B2C\".concat(index + 1, \"\\u9053\\u9898\\u662F\\u5FC5\\u586B\\u9879\\uFF0C\\u8BF7\\u586B\\u5199\"));\n          return;\n        }\n      });\n\n      if (!isStop) {\n        var dic = qs.stringify({\n          surveyQuestionId: this.surveyQuestionId,\n          surveyAnswerContent: JSON.stringify(this.questionList),\n          loginIP: localStorage.getItem(\"Ip\")\n        });\n        this.$http.post(process.env.NODE_ENV === \"development\" ? \"/api/api/survey/saveSurveyAnswer\" : \"/api/survey/saveSurveyAnswer\", dic, {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        }).then(function (res) {\n          if (res.data.success) {\n            _this2.$router.push({\n              name: \"questioncomplete\"\n            });\n          } else {\n            _this2.$router.push({\n              name: \"questionfail\"\n            });\n          }\n        });\n      }\n    }\n  },\n  watch: {\n    form: {\n      handler: function handler(val, oldVal) {\n        var _this3 = this;\n\n        // 监听表单变化\n        var writeArr = [];\n        this.questionList.forEach(function (item, index) {\n          console.log(item);\n          item.value = _this3.form[item.keys]; //赋值\n          //问题已填写\n\n          if (item.value && item.value !== (\"\" || undefined) && item.value.length !== 0) {\n            writeArr.push(item);\n          } //问题填写后又置空\n\n\n          var state = writeArr.some(function (it) {\n            return it.keys === item.keys;\n          });\n\n          if (item.value === \"\" && state) {\n            writeArr.forEach(function (items, index) {\n              if (items.keys === item.keys) {\n                writeArr.splice(inde, 1);\n              }\n            });\n          }\n        });\n        console.log(writeArr + \"填写\");\n        this.progressWidth = writeArr.length / this.questionList.length * 100;\n        this.progressWidthTest = writeArr.length + \"/\" + this.questionList.length;\n      },\n      deep: true\n    }\n  }\n};",{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"questionnaire\">\n    <div class=\"questionnaire-name\">\n      <p class=\"title\">{{title}}</p>\n      <mt-progress :value=\"progressWidth\">\n        <div class=\"progress\" slot=\"end\">{{progressWidthTest}}</div>\n      </mt-progress>\n    </div>\n    <div class=\"content\">\n      <div class=\"question-list\" v-for=\"(item,index) in questionList\" :key=\"item.keys\">\n        <div class=\"title\">\n          <span v-if=\"item.type==='Radio'\" class=\"item-type\">「单选题」</span>\n          <span v-else-if=\"item.type==='CheckBox'\" class=\"item-type\">「多选题」</span>\n          <span v-else-if=\"item.type==='Textarea'\" class=\"item-type\">「问答题」</span>\n          <span v-else-if=\"item.type==='Datepicker'\" class=\"item-type\">「日期」</span>\n          <span v-else class=\"item-type\">「时间」</span>\n          <span v-if=\"item.require==='true'\" class=\"require-statu\">*</span>\n          <span>{{index+1}}.</span>\n          {{item.name}}\n        </div>\n        <component :form=\"form\" :is=\"'Ell' + item.type\" :pitem=\"item\" :post=\"item.keys\" @showPicker=\"showPicker\" />\n      </div>\n    </div>\n    <div class=\"submit\">\n      <div class=\"button\" @click=\"submit\">提交问卷</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport EllRadio from \"../../components/questionnaire/radio\"; //单选\nimport EllTextarea from \"../../components/questionnaire/textarea\"; //问答\nimport EllCheckBox from \"../../components/questionnaire/checkbox\"; //多选\nimport EllDatepicker from \"../../components/questionnaire/datepicker\"; //日期\nimport EllTimepicker from \"../../components/questionnaire/timepicker\"; //时间\nimport { Toast } from \"mint-ui\";\nimport { isArray } from \"util\";\nimport qs from \"qs\";\nexport default {\n  components: {\n    EllRadio,\n    EllTextarea,\n    EllCheckBox,\n    EllDatepicker,\n    EllTimepicker\n  },\n  data() {\n    return {\n      form: {},\n      title: \"调查问卷\",\n      progressWidth: null,\n      progressWidthTest: \"\",\n      questionList: [],\n      surveyQuestionId: \"\"\n    };\n  },\n\n  mounted() {\n    this.surveyQuestionId = this.$route.query.id;\n    this.getData();\n  },\n  methods: {\n    showPicker(val) {\n      /*解决页面层级相互影响滑动的问题*/\n      function bodyScroll(e) {\n        e.preventDefault();\n      }\n      if (val) {\n        document.body.addEventListener(\"touchmove\", bodyScroll, false); //阻止默认事件\n      } else {\n        document.body.removeEventListener(\"touchmove\", bodyScroll, false); //打开默认事件\n      }\n    },\n    getData() {\n      let dic = qs.stringify({\n        surveyQuestionId: this.surveyQuestionId\n      });\n\n      this.$http\n        .post(\n          process.env.NODE_ENV === \"development\"\n            ? \"/api/api/surveyQuestionInfo\"\n            : \"/api/surveyQuestionInfo\",\n          dic,\n          {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          }\n        )\n        .then(res => {\n          this.questionList = [];\n          this.title = res.data.data.surveyQuestionName;\n          this.questionList = JSON.parse(res.data.data.surveyQuestionContent);\n          this.questionList.forEach(item => {\n            this.$set(this.form, item.keys, item.value);\n          });\n        });\n    },\n\n    //提交表单\n    submit() {\n      let isStop;\n      this.questionList.forEach((item, index) => {\n        if (\n          item.require == \"true\" &&\n          (item.value === undefined || item.value === \"\" || item.value === [])\n        ) {\n          //验证必填\n          isStop = true;\n          Toast(`第${index + 1}道题是必填项，请填写`);\n          return;\n        }\n      });\n      if (!isStop) {\n        let dic = qs.stringify({\n          surveyQuestionId: this.surveyQuestionId,\n          surveyAnswerContent: JSON.stringify(this.questionList),\n          loginIP: localStorage.getItem(\"Ip\")\n        });\n        this.$http\n          .post(\n            process.env.NODE_ENV === \"development\"\n              ? \"/api/api/survey/saveSurveyAnswer\"\n              : \"/api/survey/saveSurveyAnswer\",\n            dic,\n            {\n              \"Content-Type\": \"application/x-www-form-urlencoded\"\n            }\n          )\n          .then(res => {\n            if (res.data.success) {\n              this.$router.push({ name: \"questioncomplete\" });\n            } else {\n              this.$router.push({ name: \"questionfail\" });\n            }\n          });\n      }\n    }\n  },\n  watch: {\n    form: {\n      handler(val, oldVal) {\n        // 监听表单变化\n        let writeArr = [];\n        this.questionList.forEach((item, index) => {\n          console.log(item);\n          item.value = this.form[item.keys]; //赋值\n          //问题已填写\n          if (\n            item.value &&\n            item.value !== (\"\" || undefined) &&\n            item.value.length !== 0\n          ) {\n            writeArr.push(item);\n          }\n          //问题填写后又置空\n          let state = writeArr.some(it => it.keys === item.keys);\n          if (item.value === \"\" && state) {\n            writeArr.forEach((items, index) => {\n              if (items.keys === item.keys) {\n                writeArr.splice(inde, 1);\n              }\n            });\n          }\n        });\n        console.log(writeArr + \"填写\");\n        this.progressWidth = (writeArr.length / this.questionList.length) * 100;\n        this.progressWidthTest =\n          writeArr.length + \"/\" + this.questionList.length;\n      },\n      deep: true\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.questionnaire {\n  width: 100%;\n}\n.questionnaire-name {\n  width: 100%;\n  padding: 0 15px 0px;\n  background: #fff;\n  position: fixed;\n  top: 0;\n  z-index: 9;\n  .title {\n    font-size: 18px;\n    font-weight: 600;\n    margin: 22px 0 0;\n  }\n  .progress {\n    font-size: 12px;\n    color: #fcab37;\n    margin-left: 7px;\n  }\n}\n/deep/.mt-progress-runway {\n  border-radius: 4px;\n}\n/deep/.mt-progress-progress {\n  background-color: #fcab37;\n}\n.content {\n  margin-top: 93px;\n  // margin-bottom: 100px;\n  padding-bottom: 100px;\n}\n.question-list {\n  background: #fff;\n  margin: 15px;\n  padding: 13px 0 0 0;\n  .require-statu {\n    color: red;\n  }\n}\n.question-list > .title {\n  font-size: 14px;\n  color: #333333;\n  margin-bottom: 13px;\n}\n.question-list .item-type {\n  color: #fd9e2f;\n}\n.submit {\n  position: fixed;\n  bottom: 0;\n  width: 100%;\n  height: 100px;\n  background: linear-gradient(\n    0deg,\n    rgba(255, 255, 255, 1) 0%,\n    rgba(255, 255, 255, 0) 100%\n  );\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  .button {\n    width: 175px;\n    background: #fcab37;\n    height: 44px;\n    border-radius: 22px;\n    color: #fff;\n    font-size: 16px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n\n.dialog {\n  z-index: 1000;\n  width: 50px;\n  height: 50px;\n  margin: 0 auto;\n  background: red;\n}\n</style>"],"sourceRoot":"src/views/questionnaire"}]}